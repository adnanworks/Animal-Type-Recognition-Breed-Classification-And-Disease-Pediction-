{% extends 'admin/home.html' %}
{% block body %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Wildlife Place</title>

    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <style>
        #map {
            height: 300px;
            width: 100%;
        }
    </style>
</head>

<body>

<form method="POST" action="/myapp/edit_wildlife_place_post/">
    {% csrf_token %}
    <table>

        <tr>
            <td>Place Name</td>
            <td>
                <input type="text" name="place_name" value="{{ i.place_name }}" required class="form-control">
            </td>
        </tr>

        <tr>
            <td>Description</td>
            <td>
                <textarea name="description" required class="form-control">{{ i.description }}</textarea>
            </td>
        </tr>

        <tr>
            <td>Location</td>
            <td>
                <input type="text" name="location" value="{{ i.location }}" required class="form-control">
            </td>
        </tr>

        <tr>
            <td>Type</td>
            <td>
                <select name="type" class="form-control" required>
                    <option value="Popular" {% if i.type == "Popular" %}selected{% endif %}>Popular</option>
                    <option value="Non-Popular" {% if i.type == "Non-Popular" %}selected{% endif %}>Non-Popular</option>
                </select>
            </td>
        </tr>

        <tr>
            <td>Select Location on Map</td>
            <td>
                <div id="map"></div>
            </td>
        </tr>

        <tr>
            <td>Latitude</td>
            <td>
                <input type="text" name="latitute" id="latitude" value="{{ i.latitute }}" readonly class="form-control">
            </td>
        </tr>

        <tr>
            <td>Longitude</td>
            <td>
                <input type="text" name="longitude" id="longitude" value="{{ i.longitude }}" readonly class="form-control">
            </td>
        </tr>

        <tr>
            <td></td>
            <td>
                <input type="hidden" name="id" value="{{ i.id }}">
                <button type="submit" name="submit" value="edit" class="btn btn-primary">
                    Edit
                </button>
            </td>
        </tr>

    </table>
</form>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    var lat = {{ i.latitute }};
    var lng = {{ i.longitude }};

    var map = L.map('map').setView([lat, lng], 10);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
    }).addTo(map);

    var marker = L.marker([lat, lng]).addTo(map);

    map.on('click', function (e) {
        var newLat = e.latlng.lat.toFixed(6);
        var newLng = e.latlng.lng.toFixed(6);

        document.getElementById('latitude').value = newLat;
        document.getElementById('longitude').value = newLng;

        marker.setLatLng(e.latlng);
    });
</script>

</body>
</html>

{% endblock %}
